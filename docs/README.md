# Sphinx documentation of toulbar2

## step3

Livraison d’une version :

- (succédant à step1, step2) prenant en compte sous Sphinx (docs) la documentation qui existait précédemment sous Doxygen (doc).
- réorganisant le plan de la documentation (regroupements…), étant donnée la réécriture/insertion de nouvelles pages .rst.
- prenant en compte une grande partie de ce qui a été vu/dit en réunion jeudi 10 mars 2022, mais pas fini.

- supprimant de toulbar2/README.md du texte faisant doublon avec du texte du site (presentation.rst, publications.rst).
- ref_cpp.rsa a été complété.

Voir document NotesReunions.odt pour plus de details.


## General

The **'toulbar2/docs'** folder is dedicated to the **Sphinx** documentation of toulbar2.

This documentation replaces the previous .html pages of **'toulbar2/web'** folder and also most of the 'doc' folder that does not exist anymore.

This documentation **uses files of some other folders**, such as 'toulbar2/web', 'toulbar2/misc/doc'.

This documentation is **hosted on GitHub Pages**, built with **GitHub free CI/CD tool** ; with a **redirection** of current toulbar2 site to those GitHub Pages.

## Creation

- Sphinx

  - Install sphinx

        sudo apt-get install -y python3-sphinx
        sudo apt-get install -y python3-sphinx-rtd-theme

  - setup sphinx site  :

        cd docs
        sphinx-quickstart
        (...answers...)

  - conf.py :

    - change theme from 'alabaster' to 'sphinx_rtd_theme'
    - define python code path

- C++ documentation

  - generated by Doxygen + breathe : the build/xml folder content, built by
    Doxygen, is then used by Sphinx (via breathe).

  - add into toulbar2/Doxyfile.in :

        GENERATE_XML = YES

  - add 'breathe' into requirement.txt file and conf.py
    (extensions, breathe_projects).

- Documentation content

  - The .rst pages have been created from 'toulbar2/web' .html pages.
  - The documentation also contains generated (by Doxygen+breathe) 
    documentation of toulbar2 python code (toulbar2/pytoulbar2) and
    of toulbar2 C++ code (toulbar2/src).
  - Most of the documentation previously into 'doc' folder has been rewritten
    as .rst pages.

## [Local build](README/local_build.md)

## Deploy by CI/CD

- Documentation installed by CI/CD on GitHub Pages
  **toulbar2.github.io/toulbar2**.

  Redirections from the toulbar2 site main URL
  **miat.inrae.fr/toulbar2** to the documentation on GitHub Pages
  **toulbar2.github.io/toulbar2**.

- Install

  - File .github/workflows/docs-deploy.yml
  - On the repository :
    "Settings" / "Pages" choose 'gh-pages branch' under "Source"

- CI/CD result/production :

  - Doc online at : **https://toulbar2.github.io/toulbar2**

  - .pdf are accessible from .html pages (see "Resources" page).

    Also direct access :

    - https://toulbar2.github.io/toulbar2/pdf/toulbar2.pdf 
    - https://toulbar2.github.io/toulbar2/pdf/cpp_library.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/python_library.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/userdoc.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/refman.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/tutorials.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/WCSP_format.pdf  
    - https://toulbar2.github.io/toulbar2/pdf/CFN_format.pdf  

## Misc

- The Sphinx documentation (docs) requires as input data (from misc/doc) :

  - toulbar2-class.pdf 
  - out_*.txt (to be previously generated by Toulbar2_out.sh).
  - HELP file (result of command 'toulbar2 --help') : to be updated when
    toulbar2 code modifications.

- The "@mainpage" text (of src/toulbar2lib.hpp) has been manually copied into
  the .rst ("Introduction" of page « Reference Manual") => NOT generated from
  C++ source code.
- "breathe" puts at the end of one "\defgroup" text the text of Doxygen keywords
  such as "Warning" and "Note" => those keywords have been replaced by normal
  text into C++ source code for \defgroup texts, in order to keep text order.

